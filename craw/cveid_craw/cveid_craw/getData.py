import os


def get_start_url():
    cveid_start_url_path = os.getcwd() + '/data/cveid_start_url'  # 存放cveid_starturl的文件夹
    cveid_dir = 'cveid_star_url.txt'
    cveid_start_url_file_path = os.path.join('%s\%s' % (cveid_start_url_path, cveid_dir))
    with open(cveid_start_url_file_path, 'a', encoding='utf-8') as cveid_start_url_f:  # 清空
        cveid_start_url_f.seek(0)  # 清空前先定位到要开始清空的位置
        cveid_start_url_f.truncate()  # 先清空

    sha_value_cat = ['38745b427397c23f6ed92e0ed2d3e114da828672',
                     '0ea5fbc52190c28f2a1c51aca205b315bc4c6509',
                     '363372bbc3616054065946a39f4fa589eb5f0f04',
                     '5829c45b747ab5143004640f312c7f72e5b102db',
                     '1b24fccb15090079e49c0131be821c96dc2f001c',
                     'e3bb5586965f5a13bfaa78233a10ebc3f9606d12',
                     '69098b0b30799b9520bf468c7bc060a7f756abf9',
                     'd5623136f5150876a7dfba54b38fc96fe135993c',
                     '7c71486574161a851e392e2e9dcdfea2cde521c3',
                     '1f368a2d3fc25689cc46e4dcb206b4d6103aaab7',
                     '2f1f77e26ecf09cf8b4f251b1efc2b4bcad02050',
                     'e2c3963a5b4ac67dc5dc9fe39ff95f846162e52d',
                     '4160b1b268ed8bcd97bdd927802ef4922995d3d2']
    for i in range(13):
        cat_list = ['0'] * 13
        cat_list[i] = '1'
        dos, execution, overflow, memc, sqli, xss, dirtra, httprs, bypass, infor, gainpre, csrf, fileinc = cat_list
        page_num = 1
        sha_value = sha_value_cat[i]
        link = 'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page=' + str(
            page_num) + '&hasexp=0&opdos=' + dos + '&opec=' + execution + '&opov=' + overflow + '&opcsrf=' + csrf + '&opgpriv=' + gainpre + '&opsqli=' + sqli + '&opxss=' + xss + '&opdirt=' + dirtra + '&opmemc=' + memc + '&ophttprs=' + httprs + '&opbyp=' + bypass + '&opfileinc=' + fileinc + '&opginf=' + infor + '&cvssscoremin=0&cvssscoremax=0&year=0&month=0&cweid=0&order=1&trc=28068&sha=' + sha_value
        with open(cveid_start_url_file_path, 'a', encoding='utf-8') as cveid_start_url_f:  # 用a而非w，用于追加
            cveid_start_url_f.write(link + '\n')  # 记录star_url

